<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Credit Risk Predictor App</title>

  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

  <!-- Import local CSS file -->
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

</head>

<body>
  <div class="container">
    <div class="row" style="background-color: yellow;">
      <div class="input-field col s12 browser-default">
        <select id="dummyDataDropdown" onchange="fillFormWithDummyData()">
          <option value="" disabled selected>Choose your option</option>
        </select>
        <label>Select Dummy Data:</label>
      </div>
    </div>
    <h1 class="blue-text text-darken-2">Credit Risk Predictor App</h1>
    <div class="row">
      <div class="col s12">
        <div class="row">
          <div class="col s8">
            <form id="loanForm" action="predict">
              <button class="btn waves-effect waves-light" type="submit" name="action">Submit</button>
              <div class="row">
                <div class="col s12">
                  <h4>Applicant data</h4>
                </div>
              </div>
              <div class="row">
                <div class="col s6">
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="age" class="validate">
                        <option value="" disabled selected>Choose an Age Category</option>
                        <option value="2">45-54</option>
                        <option value="1">35-44</option>
                        <option value="3">55-64</option>
                        <option value="0">25-34</option>
                        <option value="4">65-74</option>
                        <option value="7">&gt;74</option>
                        <option value="6">&lt;25</option>
                      </select>
                      <label for="age">Age Category</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="race" class="validate">
                        <option value="" disabled selected>Choose a Race</option>
                        <option value="1">White</option>
                        <option value="0">Black or African American</option>
                      </select>
                      <label for="race">Race</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="ethnicity" class="validate">
                        <option value="" disabled selected>Choose an Ethnicity</option>
                        <option value="1"> Not Hispanic or Latino</option>
                        <option value="0">Hispanic or Latino</option>
                      </select>
                      <label for="ethnicity">Ethnicity</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="100000" id="income" type="number" class="validate">
                      <label for="income">Income</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="debtToIncomeRatio" class="validate">
                        <option value="" disabled selected>Choose a Debt-to-Income Ratio Category</option>
                        <option value="0.6">36%-50%</option>
                        <option value="0.2">20%-&lt;30%</option>
                        <option value="0.4">30%-&lt;36%</option>
                        <option value="1.0">&lt;20%</option>
                        <option value="0.0">&gt;60%</option>
                        <option value="0.8">50%-60%</option>
                      </select>
                      <label for="debtToIncomeRatio">Debt-to-Income Ratio Category</label>
                    </div>
                  </div>
                </div>
                <div class="col s6">
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="sex" class="validate">
                        <option value="" disabled selected>Choose a Gender</option>
                        <option value="1">Male</option>
                        <option value="2">Female</option>
                        <option value="6">Both male and female</option>
                      </select>
                      <label for="sex">Sex</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="race2" class="validate">
                        <option value="" disabled selected>Choose a Secondary Race</option>
                        <option value="0.000000">White</option>
                        <option value="0.564103">Black or African American</option>
                        <option value="0.461538">American Indian or Alaska Native</option>
                        <option value="0.487179">Asian</option>
                        <option value="0.410256">Asian Indian</option>
                        <option value="0.512821">Chinese</option>
                        <option value="0.435897">Filipino</option>
                        <option value="1.000000">Japanese</option>
                        <option value="0.538462">Korean</option>
                        <option value="0.974359">Vietnamese</option>
                        <option value="0.923077">Other Asian</option>
                      </select>
                      <label for="race2">Secondary Race</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="750" id="creditScore" type="number" class="validate">
                      <label for="creditScore">Credit Score</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Lender Credits" id="lenderCredits" type="number" class="validate">
                      <label for="lenderCredits">Lender Credits</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col s12">
                  <h4>Co-applicant</h4>
                </div>
              </div>
              <div class="row">
                <div class="col s6">
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="co_age" class="validate">
                        <option value="" disabled selected>Choose an Age Category</option>
                        <option value="2">45-54</option>
                        <option value="1">35-44</option>
                        <option value="3">55-64</option>
                        <option value="0">25-34</option>
                        <option value="4">65-74</option>
                        <option value="7">&gt;74</option>
                        <option value="6">&lt;25</option>
                      </select>
                      <label for="co_age">Age Category</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="applicantEthnicity" class="validate">
                        <option value="" disabled selected>Choose an Ethnicity</option>
                        <option value="1"> Not Hispanic or Latino</option>
                        <option value="0">Hispanic or Latino</option>
                      </select>
                      <label for="applicantEthnicity">Ethnicity</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="co_sex" class="validate">
                        <option value="" disabled selected>Choose a Gender</option>
                        <option value="1">Male</option>
                        <option value="2">Female</option>
                        <option value="5">No co-applicant</option>
                        <option value="6">Both male and female</option>
                      </select>
                      <label for="co_sex">Sex</label>
                    </div>
                  </div>
                </div>
                <div class="col s6">
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="CoapplicantRace" class="validate">
                        <option value="" disabled selected>Choose a Race</option>
                        <option value="1">White</option>
                        <option value="0">Black or African American</option>
                      </select>
                      <label for="CoapplicantRace">Race</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <select id="co_applicant_race_2" class="validate">
                        <option value="" disabled selected>Choose a Secondary Race</option>
                        <option value="0.093023">White</option>
                        <option value="0.511628">Black or African American</option>
                        <option value="0.534884">American Indian or Alaska Native</option>
                        <option value="0.465116">Asian</option>
                        <option value="0.604651">Other Asian</option>
                        <option value="0.488372">Chinese</option>
                        <option value="0.581395">Vietnamese</option>
                        <option value="1.000000">Other Pacific Islander</option>
                        <option value="0.558140">Korean</option>
                        <option value="0.930233">Native Hawaiian</option>
                        <option value="0.000000">American Indian or Alaska Native</option>
                        <option value="0.069767">Native Hawaiian or Other Pacific Islander</option>
                        <option value="0.046512">Black or African American</option>
                      </select>
                      <label for="co_applicant_race_2">Secondary Race</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col s12">
                  <h4>Property info</h4>
                </div>
              </div>
              <div class="row">
                <div class="col s6">
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Property Value" id="propertyvalue" type="number" class="validate">
                      <label for="propertyvalue">Property Value</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Lien Status" id="lienstatus" type="text" class="validate">
                      <label for="lienstatus">Lien Status</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Manufactured Home Land Property Interest"
                        id="manufacturedHomeLandPropertyInterest" type="text" class="validate">
                      <label for="manufacturedHomeLandPropertyInterest">Manufactured Home Land Property Interest</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Multifamily Affordable Units" id="multifamilyAffordableUnits" type="number"
                        class="validate">
                      <label for="multifamilyAffordableUnits">Multifamily Affordable Units</label>
                    </div>
                  </div>
                </div>
                <div class="col s6">
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Occupancy Type" id="occupancyType" type="text" class="validate">
                      <label for="occupancyType">Occupancy Type</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Manufactured Home Secured Property Type"
                        id="manufacturedHomeSecuredPropertyType" type="text" class="validate">
                      <label for="manufacturedHomeSecuredPropertyType">Manufactured Home Secured Property Type</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Total Units" id="totalUnits" type="number" class="validate">
                      <label for="totalUnits">Total Units</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col s12">
                  <h4>Loan details</h4>
                </div>
              </div>
              <div class="row">
                <div class="col s6">
                  <div class="row">
                    <div class="input-field col s12">
                      <input id="loanAmount" type="number" class="validate">
                      <label for="loanAmount">Loan Amount</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                        <select id="interestRate" class="validate">
                            <option value="" disabled selected>Choose an Interest Rate Category</option>
                            <option value="1">0.0-1.0</option>
                            <option value="2">1.0-2.0</option>
                            <option value="3">2.0-3.0</option>
                            <option value="4">3.0-3.5</option>
                            <option value="5">3.5-4.0</option>
                            <option value="6">4.0-4.5</option>
                            <option value="7">4.5-5.0</option>
                            <option value="8">5.0-6.0</option>
                            <option value="9">6.0-7.0</option>
                            <option value="10">7.0-8.0</option>
                            <option value="11">8.0-9.0</option>
                        </select>
                        <label for="interestRate">Interest Rate Category</label>
                    </div>
                </div>                
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Total Points and Fees" id="totalpointsandfees" type="text" class="validate">
                      <label for="totalpointsandfees">Total Points and Fees</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Loan Term" id="loanterm" type="text" class="validate">
                      <label for="loanterm">Loan Term</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Discount Points" id="discountPoints" type="number" class="validate">
                      <label for="discountPoints">Discount Points</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Prepayment Penalty Term" id="prepaymentPenaltyTerm" type="number"
                        class="validate">
                      <label for="prepaymentPenaltyTerm">Prepayment Penalty Term</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Negative Amortization" id="negativeAmortization" type="text" class="validate">
                      <label for="negativeAmortization">Negative Amortization</label>
                    </div>
                  </div>
                </div>
                <div class="col s6">
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Total Loan Costs" id="totalloancosts" type="text" class="validate">
                      <label for="totalloancosts">Total Loan Costs</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Loan Type" id="loantype" type="text" class="validate">
                      <label for="loantype">Loan Type</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Loan Purpose" id="loanpurpose" type="text" class="validate">
                      <label for="loanpurpose">Loan Purpose</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Origination Charges" id="originationCharges" type="number" class="validate">
                      <label for="originationCharges">Origination Charges</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Interest-Only Payment" id="interestOnlyPayment" type="text" class="validate">
                      <label for="interestOnlyPayment">Interest-Only Payment</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Balloon Payment" id="balloonPayment" type="text" class="validate">
                      <label for="balloonPayment">Balloon Payment</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input placeholder="Other Nonamortizing Features" id="otherNonamortizingFeatures" type="text"
                        class="validate">
                      <label for="otherNonamortizingFeatures">Other Nonamortizing Features</label>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="col s3">
            <h2>Prediction:</h2>
            <p id="prediction">Result: </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>

  <!-- Import Materialize JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>


  <!-- Filling the dummy dropdown -->
  <script>

    let dummyData;

    // Load dummy data from JSON
    fetch('./static/testdata.json')
      .then(response => response.json())
      .then(data => {
        dummyData = data;
        console.log('Dummy data loaded:', dummyData);
        populateDropdown();
      })
      .catch(error => console.error('Error loading dummy data:', error));


    // Function to fill form with dummy data
    function populateDropdown() {
      const dropdown = document.getElementById('dummyDataDropdown');
      for (const key in dummyData) {
        if (dummyData.hasOwnProperty(key)) {
          const option = document.createElement('option');
          option.value = key;
          option.textContent = key;
          dropdown.appendChild(option);
        }
      }

      // Initialize Materialize select elements
      var elems = document.querySelectorAll('select');
      var instances = M.FormSelect.init(elems);

      console.log('Dropdown populated with options:', dropdown.innerHTML);
    }



    //Filling the from with dummy data
    function fillFormWithDummyData() {
      const selectedOption = document.getElementById('dummyDataDropdown').value;
      const data = dummyData[selectedOption];

      console.log('Selected Option:', selectedOption);
      console.log('Data:', data);

      if (data) {
        // Fill the form fields with dummy data

        // age
        const ageSelect = document.getElementById('age');
        const selectedAgeValue = data.applicantData.age.toString();
        ageSelect.value = selectedAgeValue;
        M.FormSelect.init(ageSelect);

        // race / race2
        const raceSelect = document.getElementById('race');
        const selectedRaceValue = data.applicantData.race.toString();
        raceSelect.value = selectedRaceValue;
        M.FormSelect.init(raceSelect);
        const raceSelect2 = document.getElementById('race2');
        const selectedRaceValue2 = data.applicantData.race2.toString();
        raceSelect2.value = selectedRaceValue2;
        M.FormSelect.init(raceSelect2);

        //appllicant sex
        document.getElementById('sex').value = data.applicantData.sex;
        const sexSelect = document.getElementById('sex');
        const selectedSexValue = data.applicantData.sex.toString();
        sexSelect.value = selectedSexValue;
        M.FormSelect.init(sexSelect);

        //appllicant ethnicity
        document.getElementById('ethnicity').value = data.applicantData.sex;
        const ethnicitySelect = document.getElementById('ethnicity');
        const selectedEthnicityValue = data.applicantData.sex.toString();
        ethnicitySelect.value = selectedEthnicityValue;
        M.FormSelect.init(ethnicitySelect);


        document.getElementById('income').value = data.applicantData.income;


        // debt to income ratio
        const debtToIncomeRatioSelect = document.getElementById('debtToIncomeRatio');
        const selectedDebtToIncomeRatio = data.applicantData.debtToIncomeRatio.toString();
        debtToIncomeRatioSelect.value = selectedDebtToIncomeRatio;
        M.FormSelect.init(debtToIncomeRatioSelect);

        document.getElementById('creditScore').value = data.applicantData.creditScore;
        document.getElementById('lenderCredits').value = data.applicantData.lenderCredits;

        // co appllicant age
        const ageSelect2 = document.getElementById('co_age');
        const selectedAgeValue2 = data.coApplicantData.co_age.toString();
        ageSelect2.value = selectedAgeValue2;
        M.FormSelect.init(ageSelect2);

        // co appllicant race / race2
        const coraceSelect = document.getElementById('CoapplicantRace');
        const coselectedRaceValue = data.coApplicantData.CoapplicantRace.toString();
        coraceSelect.value = coselectedRaceValue;
        M.FormSelect.init(coraceSelect);

        const coraceSelect2 = document.getElementById('co_applicant_race_2');
        const coselectedRaceValue2 = data.coApplicantData.co_applicant_race_2.toString();
        coraceSelect2.value = coselectedRaceValue2;
        M.FormSelect.init(coraceSelect2);

        // co appllicant sex
        document.getElementById('co_sex').value = data.coApplicantData.co_sex;
        const sexSelect2 = document.getElementById('co_sex');
        const selectedSexValue2 = data.coApplicantData.co_sex.toString();
        sexSelect2.value = selectedSexValue2;
        M.FormSelect.init(sexSelect2);

        //co-appllicant ethnicity
        document.getElementById('applicantEthnicity').value = data.applicantData.sex;
        const ethnicitySelect2 = document.getElementById('applicantEthnicity');
        const selectedEthnicityValue2 = data.applicantData.sex.toString();
        ethnicitySelect2.value = selectedEthnicityValue2;
        M.FormSelect.init(ethnicitySelect2);


        document.getElementById('propertyvalue').value = data.propertyInfo.propertyValue;
        document.getElementById('lienstatus').value = data.propertyInfo.lienStatus;
        document.getElementById('manufacturedHomeLandPropertyInterest').value = data.propertyInfo.manufacturedHomeLandPropertyInterest;
        document.getElementById('multifamilyAffordableUnits').value = data.propertyInfo.multifamilyAffordableUnits;
        document.getElementById('occupancyType').value = data.propertyInfo.occupancyType;
        document.getElementById('manufacturedHomeSecuredPropertyType').value = data.propertyInfo.manufacturedHomeSecuredPropertyType;
        document.getElementById('totalUnits').value = data.propertyInfo.totalUnits;

        document.getElementById('loanAmount').value = data.loanDetails.loanAmount;


        document.getElementById('interestRate').value = data.loanDetails.interestRate;
        
        // interest rate
        document.getElementById('interestRate').value = data.loanDetails.interestRate;
        const interestRateSelect = document.getElementById('interestRate');
        const selectedinterestRateValue = data.loanDetails.interestRate.toString();
        interestRateSelect.value = selectedinterestRateValue;
        M.FormSelect.init(interestRateSelect);

        document.getElementById('totalpointsandfees').value = data.loanDetails.totalpointsandfees;
        document.getElementById('loanterm').value = data.loanDetails.loanterm;
        document.getElementById('discountPoints').value = data.loanDetails.discountPoints;
        document.getElementById('prepaymentPenaltyTerm').value = data.loanDetails.prepaymentPenaltyTerm;
        document.getElementById('negativeAmortization').value = data.loanDetails.negativeAmortization;
        document.getElementById('totalloancosts').value = data.loanDetails.totalloancosts;
        document.getElementById('loantype').value = data.loanDetails.loantype;
        document.getElementById('loanpurpose').value = data.loanDetails.loanpurpose;
        document.getElementById('originationCharges').value = data.loanDetails.originationCharges;
        document.getElementById('interestOnlyPayment').value = data.loanDetails.interestOnlyPayment;
        document.getElementById('balloonPayment').value = data.loanDetails.balloonPayment;
        document.getElementById('otherNonamortizingFeatures').value = data.loanDetails.otherNonamortizingFeatures;


        console.log('Form fields filled with data:', data);
      } else {
        console.error('No data found for the selected option.');
      }
    }
  </script>

  <script>
    // Your JavaScript code here
    // Handle Form Submission
    async function handleFormSubmission(formData) {
      try {
        const predictionData = await fetchPredictionData(formData);
        updatePrediction(predictionData);
      } catch (error) {
        console.error('Error predicting:', error);
      }
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', function () {
      // Materialize select elements
      var elems = document.querySelectorAll('select');
      var instances = M.FormSelect.init(elems);

      // Add an event listener to the form submit button
      document.getElementById('loanForm').addEventListener('submit', function (event) {
        event.preventDefault();
        predictLoan();
      });
    });


  </script>

  <script>


    // Function to gather form data
    function PrepareFormData() {
      // Gather all the form values
      const formData = {};
      const formElements = [
        'age', 'income', 'race', 'sex', 'ethnicity', 'lenderCredits',
        'debtToIncomeRatio', 'creditScore', 'loanAmount', 'interestRate',
        'totalpointsandfees', 'loanterm', 'discountPoints', 'prepaymentPenaltyTerm',
        'negativeAmortization', 'totalloancosts', 'loantype', 'loanpurpose',
        'originationCharges', 'interestOnlyPayment', 'balloonPayment',
        'otherNonamortizingFeatures',
        'co_age', 'CoapplicantRace', 'co_sex', 'CoapplicantEthnicity',
        'propertyValue', 'lienStatus', 'manufacturedHomeLandPropertyInterest',
        'multifamilyAffordableUnits', 'occupancyType', 'manufacturedHomeSecuredPropertyType',
        'totalUnits', 'race2', 'co_applicant_race_2'
      ];

      const dataMappings = {
        'age': 'applicant_age',
        'sex': 'applicant_sex',
        'race': 'applicant_race_1',
        'ethnicity': 'applicant_ethnicity_1',
        'loantype': 'loan_type',
        'income': 'income',
        'lenderCredits': 'lenderCredits',
        'debtToIncomeRatio': 'debt_to_income_ratio',
        'creditScoreType': 'applicant_credit_score_type',
        'loanAmount': 'loanAmount',
        'interestRate': 'interestRate',
        'totalpointsandfees': 'totalpointsandfees',
        'loanterm': 'loanterm',
        'discountPoints': 'discountPoints',
        'prepaymentPenaltyTerm': 'prepaymentPenaltyTerm',
        'negativeAmortization': 'negativeAmortization',
        'totalloancosts': 'totalloancosts',
        'loantype': 'loan_type',
        'loanpurpose': 'loanpurpose',
        'originationCharges': 'originationCharges',
        'interestOnlyPayment': 'interestOnlyPayment',
        'balloonPayment': 'balloonPayment',
        'otherNonamortizingFeatures': 'otherNonamortizingFeatures',
        'co_age': 'co_applicant_age',
        'CoapplicantRace': 'co_applicant_race_1',
        'co_sex': 'co_applicant_sex',
        'CoapplicantEthnicity': 'co_applicant_ethnicity_1',
        'propertyValue': 'propertyValue',
        'lienStatus': 'lien_status',
        'manufacturedHomeLandPropertyInterest': 'manufactured_home_land_property_interest',
        'multifamilyAffordableUnits': 'multifamily_affordable_units',
        'occupancyType': 'occupancy_type',
        'manufacturedHomeSecuredPropertyType': 'manufactured_home_secured_property_type',
        'totalUnits': 'total_units',
        'race2': 'applicant_race_2',
        'co_applicant_race_2': 'co_applicant_race_2',
      };

      const intDtypes = [
        'loan_type', 'lien_status', 'loan_amount', 'loan_term', 'negative_amortization',
        'interest_only_payment', 'balloon_payment', 'other_nonamortizing_features',
        'occupancy_type', 'manufactured_home_secured_property_type',
        'manufactured_home_land_property_interest', 'total_units',
        'debt_to_income_ratio', 'applicant_age', 'co_applicant_age', 'aus_1', 'applicant_credit_score_type'
      ];

      const floatDtypes = [
        'census_tract', 'interest_rate', 'property_value', 'income',
        'applicant_race_1', 'applicant_race_2', 'co_applicant_race_1',
        'co_applicant_race_2', 'applicant_ethnicity_1', 'co_applicant_ethnicity_1'
      ];


      formElements.forEach(element => {
        const inputElement = document.getElementById(element);
        if (inputElement) {
          const mappedName = dataMappings[element] || element; // Use the mapped name or the original if no mapping
          let value = inputElement.value;
          value = parseFloat(value);

          formData[mappedName] = value;
        }
      });

      console.log(formData);

      return formData;
    }

    // Fetch Prediction Data
    async function fetchPredictionData(formData) {
      const response = await fetch('/predict', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json', // Change the Content-Type to application/json
        },
        body: JSON.stringify(formData) // Send the data as JSON
      });
      return await response.json();
    }

    /* ----------------------Predict loan acceptance from form data ---------------------------   */
    // Function to send form data for prediction
    async function predictLoan() {
      // Define the data to be sent
      const formData = PrepareFormData();

      // Make the AJAX request
      $.ajax({
        type: 'POST',
        contentType: 'application/json',
        url: '/predict',
        dataType: 'json',
        data: JSON.stringify(formData), // Sending the formData
        success: function (result) {
          console.log('Received result:', result);
          const predictionElement = document.getElementById('prediction');
          predictionElement.innerText = `Predicted class: ${result.prediction}`;
        },
        error: function (error) {
          console.error('Error:', error);
          const predictionElement = document.getElementById('prediction');
          predictionElement.innerText = `error: ${error.message}`;
        }
      });
    }

  </script>



</body>

</html>